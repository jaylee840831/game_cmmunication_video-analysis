<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>chat</title>
<link rel="stylesheet"  href="/css/navigationbar.css">
<link rel="stylesheet"  href="/css/chat.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.0/handlebars.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.12/vue.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<link href= "https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
 <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap4.min.css">
 <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap4.min.css">
 <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
 <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
 <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap4.min.js"></script>
 <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
 <script src="https://cdn.datatables.net/responsive/2.2.9/js/responsive.bootstrap4.min.js"></script>
 <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" type="text/css" rel="stylesheet">
  <!--    libs for stomp and sockjs-->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.4.0/sockjs.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
 <style>
 	/*html,body{
 		background-image: url("/images/basketballplayer.png");
		background-repeat: no-repeat;
		background-attachment:fixed;
		height: 100%;
  		margin: 0;
  		padding:0;
  		}*/
 </style>
</head>
<body>

<div id="wrapper">
	<nav id="sidebar">
		<div class="sidebar-header">
			<h5><a href="/">首頁</a></h5>
		</div>
		<ul class="lisst-unstyled components">
			<li>
				<a href="/person">個人資料</a>
			</li>
			<li>
				<a href="#">發起球局</a>
			</li>
			<li>
				<a href="#">球局歷史紀錄</a>
			</li>
			<li>
				<a href="#">影片分析</a>
			</li>
			<li>
				<a href="/chat">聊天室</a>
			</li>
			<li>
				<a id="logout" href="/logout">登出</a>
			</li>
		</ul>
	</nav>
	
	<div id="content">
		<nav class="navbar navbar-expand-lg">
			<div class="container-fluid">
				<button type="button" id="sidebarCollapse" class="btn" style="position:absolute;">
					<img src="/images/navigation-icon.png">	
				</button>
			</div>
		</nav>
		
		<br>
		
<div class="container">
<div class="messaging">
      <div class="inbox_msg chat_background">
        <div class="inbox_people" style="background-color:#6C6C6C;">
	          <div class="headind_srch">
	                <input id="userName" type="text" class="search-bar"  placeholder="搜尋" style="background-color:#F0F0F0;">
	                <button type="button"> <i class="fa fa-search" aria-hidden="true"></i> </button>
	                <input id="from_username" type="text" class="search-bar"  placeholder="Search" style="display:none;">
	          </div>
	          <!-- 好友列表 -->
	          <div class="inbox_chat">
					<ul id="usersList" class="list">
					</ul>
	          </div>
        </div>
        
        <div class="mesgs chat_background">
          <div class="msg_history">
          
          	<!-- 大頭照與姓名 -->
	        <div style="display:flex; justify-content:center;"> 
	       		<div>
			       <img id="selectUser-image" alt="" height="90px" width="90px"
			            src=""
			            style="border-top-left-radius: 50% 50%; border-top-right-radius: 50% 50%; border-bottom-right-radius: 50% 50%; border-bottom-left-radius: 50% 50%;"
			         	/>
		       </div>
				<div style="display:flex; align-items:center;">
		       		<h5 class="chat-with" id="selectedUserId" style="font-weight:bold;"></h5>
		       </div>
	       </div>
        
        	<!-- 訊息對話 -->
	        <div class="chat-history">
	            <ul id="history-ul">
	
	            </ul>
	        </div> <!-- end chat-history -->
		  </div>
	        
	      <div class="type_msg">
            <div class="input_msg_write">
	          <!-- 傳訊息框與傳送按鈕 -->
	            <input id="message-to-send" name="message-to-send" placeholder="輸入您的訊息" />
	
	            <!--<i class="fa fa-file-o"></i> &nbsp;&nbsp;&nbsp;
	            <i class="fa fa-file-image-o"></i>-->
	
	            <button id="sendBtn" class="msg_send_btn"><i class="fa fa-paper-plane-o" aria-hidden="true"></i></button>
	
	        </div>
	      </div>
        </div>  <!-- end chat-message -->
        
      </div>
      
      
      <p class="text-center top_spac">HTML & CSS template design by <a target="_blank" href="https://www.linkedin.com/in/sunil-rajput-nattho-singh/">Sunil Rajput</a></p>
      <p class="text-center top_spac">source code <a target="_blank" href="https://bootsnipp.com/snippets/1ea0N">https://bootsnipp.com/snippets/1ea0N</a></p>
      
    </div></div>
		
	</div>
</div>

<!-- 自己訊息 -->
<script id="message-template" type="text/x-handlebars-template">
    <li class="clearfix">
        <div class="message other-message float-right" style="border-radius:10px;background-color:#53FF53;padding:10px 20px;">
            {{messageOutput}}
        </div>
		<br/><br/>
        <div class="message-data float-right">
			 <span class="message-data-name"></span>
            <span class="message-data-time">{{time}}, Today</span>
        </div>
    </li>
	<br/><br/>
</script>

<!-- 別人訊息 -->
<script id="message-response-template" type="text/x-handlebars-template">
    <li>
		<span class="message-data-name getname">{{userName}}</span>
		<br/>
        <div class="message my-message float-left" style="border-radius:10px;background-color:#BEBEBE;padding:10px 20px;">
            {{response}}
        </div>
		<br/><br/>
        <div class="message-data">
            <span class="message-data-time">{{time}}, Today</span>
        </div>
    </li>
	<br/><br/>
</script>

<script>

window.onload=function(){
	fetchAll();
	$("#history-ul").html('');
	$('#selectUser-image').hide();
}

$(document).ready(function(){
	
	//$(".container").fadeIn(3000);
	
	$("#sidebarCollapse").on('click',function(){
		$("#sidebar").toggleClass('active');
	});
	
	$("#sidebarCollapse").animate({left: '-20px'}, "slow");
	
	var get_person='/api/v1/GET/person'	
		//取得使用者資料
		$.ajax({
		    type: "GET",
		    url: get_person,
		    dataType: "json",
		    success: function (response) {
		    	
		    	//if(response.image!=null){
		    		//$('#img').attr('src', 'data:image/png;base64,'+response.image);
		    	//}
		    	
		    	if(response.username!=null){
		    		registration(response.username)
		    		$('#from_username').val(response.username);
		    	}
		    },
		    error: function (thrownError) {
		      console.log(thrownError);
		    }
		  });
});
	
</script>

<script src="js/chat.js"></script>
<script src="js/custom.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>